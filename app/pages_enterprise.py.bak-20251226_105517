# app/pages_enterprise.py
"""
Enterprise SaaS Seiten f√ºr Contract Intelligence
Mit exakt gleichem Header/Footer wie Upload-Page
"""

from datetime import datetime


# =============================================================================
# SHARED STYLES (identisch mit frontend.py)
# =============================================================================

PAGE_CSS = '''
<style>
@import url("https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap");

:root {
  --sbs-blue: #003856;
  --sbs-blue-dark: #002a42;
  --sbs-blue-light: #00507a;
  --sbs-yellow: #FFB900;
  --sbs-bg: #f4f7fa;
  --sbs-text: #111827;
  --sbs-muted: #6b7280;
  --sbs-border: #e5e7eb;
  --sbs-card: #ffffff;
  --sbs-success: #10b981;
  --sbs-warning: #f59e0b;
  --sbs-danger: #ef4444;
}

*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

body {
  font-family: "Inter", system-ui, -apple-system, sans-serif;
  background: var(--sbs-bg);
  color: var(--sbs-text);
  min-height: 100vh;
  display: flex;
  flex-direction: column;
}

header {
  background: #fff;
  border-bottom: 1px solid var(--sbs-border);
  box-shadow: 0 2px 8px rgba(0,0,0,0.04);
  position: sticky;
  top: 0;
  z-index: 100;
}

.header-container {
  max-width: 1400px;
  margin: 0 auto;
  padding: 0 24px;
  display: flex;
  justify-content: space-between;
  align-items: center;
  height: 72px;
}

.header-logo {
  display: flex;
  align-items: center;
  gap: 12px;
  text-decoration: none;
}

.header-logo img { height: 40px; width: auto; }

.header-logo-text { display: flex; flex-direction: column; line-height: 1.3; }
.header-logo-text .brand { font-size: 15px; font-weight: 600; color: var(--sbs-blue); }
.header-logo-text .subtitle { font-size: 12px; color: var(--sbs-muted); }

.header-nav { display: flex; align-items: center; gap: 8px; }

.header-nav a {
  padding: 10px 16px;
  font-size: 14px;
  font-weight: 500;
  color: var(--sbs-text);
  text-decoration: none;
  border-radius: 6px;
  transition: all 0.15s ease;
}

.header-nav a:hover { background: rgba(0,56,86,0.05); color: var(--sbs-blue); }
.header-nav a.active { color: var(--sbs-blue); background: rgba(0,56,86,0.08); }

.dropdown { position: relative; }

.dropdown-toggle {
  display: flex;
  align-items: center;
  gap: 6px;
  padding: 10px 16px;
  font-size: 14px;
  font-weight: 500;
  color: var(--sbs-text);
  background: none;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.dropdown-toggle:hover { background: rgba(0,56,86,0.05); color: var(--sbs-blue); }
.dropdown-toggle svg { width: 16px; height: 16px; transition: transform 0.2s ease; }
.dropdown:hover .dropdown-toggle svg { transform: rotate(180deg); }

.dropdown-menu {
  position: absolute;
  top: 100%;
  right: 0;
  min-width: 220px;
  background: #fff;
  border: 1px solid var(--sbs-border);
  border-radius: 12px;
  box-shadow: 0 10px 40px rgba(0,0,0,0.12);
  padding: 8px;
  opacity: 0;
  visibility: hidden;
  transform: translateY(8px);
  transition: all 0.2s ease;
  z-index: 1001;
}

.dropdown:hover .dropdown-menu { opacity: 1; visibility: visible; transform: translateY(0); }

.dropdown-section { padding: 4px 0; }
.dropdown-section:not(:last-child) { border-bottom: 1px solid var(--sbs-border); margin-bottom: 4px; padding-bottom: 8px; }
.dropdown-label { font-size: 11px; font-weight: 600; color: var(--sbs-muted); text-transform: uppercase; letter-spacing: 0.05em; padding: 8px 12px 4px; }

.dropdown-item {
  display: flex;
  align-items: center;
  gap: 10px;
  padding: 10px 12px;
  font-size: 14px;
  color: var(--sbs-text);
  text-decoration: none;
  border-radius: 8px;
  transition: all 0.15s ease;
}

.dropdown-item:hover { background: rgba(0,56,86,0.05); color: var(--sbs-blue); }
.dropdown-item .icon { font-size: 16px; width: 20px; text-align: center; }
.dropdown-item.cross-link { color: var(--sbs-yellow); font-weight: 500; }
.dropdown-item.cross-link:hover { background: rgba(255,185,0,0.1); }

.user-btn {
  display: flex;
  align-items: center;
  gap: 8px;
  padding: 6px 12px 6px 6px;
  background: rgba(0,56,86,0.05);
  border: none;
  border-radius: 999px;
  cursor: pointer;
  transition: all 0.15s ease;
}

.user-btn:hover { background: rgba(0,56,86,0.1); }

.user-avatar {
  width: 32px;
  height: 32px;
  background: var(--sbs-blue);
  color: #fff;
  border-radius: 50%;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 14px;
  font-weight: 600;
}

.user-name { font-size: 14px; font-weight: 500; color: var(--sbs-text); }
.user-btn svg { width: 16px; height: 16px; color: var(--sbs-muted); }

main { flex: 1; }

.hero {
  background: linear-gradient(135deg, var(--sbs-blue) 0%, var(--sbs-blue-dark) 100%);
  color: #fff;
  padding: 48px 24px;
}

.hero .container { max-width: 1400px; margin: 0 auto; }
.hero-badge { display: inline-flex; align-items: center; gap: 8px; background: rgba(255,255,255,0.1); padding: 8px 16px; border-radius: 999px; font-size: 13px; font-weight: 500; margin-bottom: 20px; }
.hero-badge .dot { width: 8px; height: 8px; background: var(--sbs-yellow); border-radius: 50%; }
.hero h1 { font-size: 2.25rem; font-weight: 700; margin-bottom: 12px; color: #fff; }
.hero p { font-size: 1.1rem; opacity: 0.9; max-width: 600px; }

.page-container { max-width: 1200px; margin: 0 auto; padding: 40px 24px; }

.stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 32px; }
@media (max-width: 768px) { .stats-grid { grid-template-columns: repeat(2, 1fr); } }

.stat-card { background: #fff; border-radius: 12px; padding: 24px; border: 1px solid var(--sbs-border); box-shadow: 0 2px 8px rgba(0,0,0,0.04); }
.stat-value { font-size: 2rem; font-weight: 700; color: var(--sbs-blue); margin-bottom: 4px; }
.stat-label { font-size: 0.85rem; color: var(--sbs-muted); }

.content-card { background: #fff; border-radius: 16px; border: 1px solid var(--sbs-border); box-shadow: 0 4px 24px rgba(0,0,0,0.06); margin-bottom: 24px; }
.content-card-header { display: flex; justify-content: space-between; align-items: center; padding: 20px 24px; border-bottom: 1px solid var(--sbs-border); }
.content-card-title { font-size: 1.1rem; font-weight: 600; color: var(--sbs-blue); }
.content-card-body { padding: 24px; }

.data-table { width: 100%; border-collapse: collapse; }
.data-table th, .data-table td { padding: 14px 16px; text-align: left; border-bottom: 1px solid var(--sbs-border); }
.data-table th { font-size: 0.75rem; font-weight: 600; color: var(--sbs-muted); text-transform: uppercase; letter-spacing: 0.05em; background: #fafbfc; }
.data-table tr:hover { background: rgba(0,56,86,0.02); }

.badge { display: inline-flex; align-items: center; padding: 4px 10px; border-radius: 12px; font-size: 0.75rem; font-weight: 600; }
.badge-success { background: rgba(16,185,129,0.1); color: #059669; }
.badge-warning { background: rgba(245,158,11,0.1); color: #d97706; }
.badge-danger { background: rgba(239,68,68,0.1); color: #dc2626; }
.badge-info { background: rgba(0,56,86,0.1); color: var(--sbs-blue); }

.form-group { margin-bottom: 20px; }
.form-label { display: block; font-size: 0.9rem; font-weight: 500; color: var(--sbs-text); margin-bottom: 8px; }
.form-input { width: 100%; padding: 12px 16px; font-size: 0.95rem; border: 1px solid var(--sbs-border); border-radius: 8px; transition: all 0.2s; }
.form-input:focus { outline: none; border-color: var(--sbs-blue); box-shadow: 0 0 0 3px rgba(0,56,86,0.1); }
.form-hint { font-size: 0.8rem; color: var(--sbs-muted); margin-top: 6px; }

.grid-2 { display: grid; grid-template-columns: repeat(2, 1fr); gap: 24px; }
.grid-3 { display: grid; grid-template-columns: repeat(3, 1fr); gap: 24px; }
@media (max-width: 768px) { .grid-2, .grid-3 { grid-template-columns: 1fr; } }

.btn { display: inline-flex; align-items: center; justify-content: center; gap: 8px; padding: 12px 24px; font-size: 14px; font-weight: 600; border: none; border-radius: 8px; cursor: pointer; transition: all 0.2s; text-decoration: none; }
.btn-primary { background: var(--sbs-yellow); color: var(--sbs-blue); }
.btn-primary:hover { background: var(--sbs-blue); color: #fff; }
.btn-secondary { background: #f3f4f6; color: var(--sbs-text); border: 1px solid var(--sbs-border); }
.btn-secondary:hover { background: #e5e7eb; }
.btn-danger { background: #dc2626; color: #fff; }
.btn-danger:hover { background: #b91c1c; }

.empty-state { text-align: center; padding: 60px 20px; color: var(--sbs-muted); }
.empty-icon { font-size: 4rem; margin-bottom: 16px; opacity: 0.5; }

.plan-card { background: #fff; border: 2px solid var(--sbs-border); border-radius: 16px; padding: 32px; text-align: center; transition: all 0.2s; }
.plan-card:hover { border-color: var(--sbs-blue); }
.plan-card.current { border-color: var(--sbs-yellow); background: linear-gradient(135deg, #fffbeb 0%, #fef3c7 100%); }
.plan-price { font-size: 2.5rem; font-weight: 700; color: var(--sbs-blue); }
.plan-features { list-style: none; text-align: left; margin: 24px 0; }
.plan-features li { padding: 10px 0; border-bottom: 1px solid var(--sbs-border); font-size: 0.9rem; }

.user-row { display: flex; align-items: center; gap: 16px; }
.user-avatar-large { width: 48px; height: 48px; background: var(--sbs-blue); color: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 18px; font-weight: 600; }
.user-info { flex: 1; }
.user-info strong { display: block; margin-bottom: 2px; }
.user-info small { color: var(--sbs-muted); }

footer { background: var(--sbs-blue-dark); color: #fff; margin-top: auto; }
.footer-container { max-width: 1400px; margin: 0 auto; padding: 64px 24px 32px; }
.footer-grid { display: grid; grid-template-columns: 1.5fr 1fr 1fr 1fr; gap: 48px; margin-bottom: 48px; }
@media (max-width: 768px) { .footer-grid { grid-template-columns: 1fr 1fr; gap: 32px; } }
.footer-brand { display: flex; flex-direction: column; gap: 16px; }
.footer-logo { display: flex; align-items: center; gap: 12px; }
.footer-logo img { height: 36px; width: auto; filter: brightness(0) invert(1); }
.footer-logo-text .name { font-size: 16px; font-weight: 600; color: #fff; }
.footer-logo-text .sub { font-size: 13px; color: rgba(255,255,255,0.7); }
.footer-tagline { font-size: 14px; color: rgba(255,255,255,0.7); line-height: 1.6; }
.footer-address { display: flex; align-items: center; gap: 8px; font-size: 14px; color: rgba(255,255,255,0.6); }
.footer-section h4 { font-size: 14px; font-weight: 600; color: var(--sbs-yellow); margin-bottom: 20px; text-transform: uppercase; letter-spacing: 0.03em; }
.footer-section ul { list-style: none; }
.footer-section li { margin-bottom: 12px; }
.footer-section a { font-size: 14px; color: rgba(255,255,255,0.8); text-decoration: none; transition: color 0.15s; }
.footer-section a:hover { color: #fff; }
.footer-bottom { border-top: 1px solid rgba(255,255,255,0.1); padding-top: 24px; text-align: center; font-size: 14px; color: rgba(255,255,255,0.5); }
</style>
'''


def get_header(user_name: str = "User", active: str = ""):
    """Header exakt wie in der Upload-Page."""
    user_initial = user_name[0].upper() if user_name else "U"
    
    return f'''
<header>
  <div class="header-container">
    <a href="/" class="header-logo">
      <img src="/static/sbs-logo-new.png" alt="SBS Logo">
      <div class="header-logo-text">
        <span class="brand">SBS Deutschland</span>
        <span class="subtitle">Smart Business Service ¬∑ Weinheim</span>
      </div>
    </a>
    <nav class="header-nav">
      <a href="/upload" class="{"active" if active == "analyse" else ""}">Analyse</a>
      <a href="/history" class="{"active" if active == "verlauf" else ""}">Verlauf</a>
      <a href="/analytics" class="{"active" if active == "analytics" else ""}">Analytics</a>
      
      <div class="dropdown">
        <button class="dropdown-toggle">
          Tools
          <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>
        </button>
        <div class="dropdown-menu">
          <div class="dropdown-section">
            <a href="/compare" class="dropdown-item"><span class="icon">‚öñÔ∏è</span> Vertragsvergleich</a>
            <a href="/library" class="dropdown-item"><span class="icon">üìö</span> Klausel-Bibliothek</a>
            <a href="/exports" class="dropdown-item"><span class="icon">üì•</span> Export-Historie</a>
          </div>
          <div class="dropdown-section">
            <a href="https://app.sbsdeutschland.com" class="dropdown-item cross-link"><span class="icon">üìÑ</span> ‚Üí KI-Rechnungen</a>
          </div>
        </div>
      </div>
      
      <div class="dropdown">
        <button class="user-btn">
          <div class="user-avatar">{user_initial}</div>
          <span class="user-name">{user_name}</span>
          <svg viewBox="0 0 20 20" fill="currentColor"><path fill-rule="evenodd" d="M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z" clip-rule="evenodd"/></svg>
        </button>
        <div class="dropdown-menu">
          <div class="dropdown-section">
            <div class="dropdown-label">Workspace</div>
            <a href="/upload" class="dropdown-item"><span class="icon">üîç</span> Analyse</a>
            <a href="/history" class="dropdown-item"><span class="icon">üìä</span> Verlauf</a>
            <a href="/analytics" class="dropdown-item"><span class="icon">üìà</span> Analytics</a>
            <a href="/exports" class="dropdown-item"><span class="icon">üì•</span> Export-Historie</a>
          </div>
          <div class="dropdown-section">
            <div class="dropdown-label">Konto</div>
            <a href="/settings" class="dropdown-item"><span class="icon">‚öôÔ∏è</span> Einstellungen</a>
            <a href="/billing" class="dropdown-item"><span class="icon">üí≥</span> Abrechnung</a>
            <a href="/team" class="dropdown-item"><span class="icon">üë•</span> Team</a>
            <a href="/audit" class="dropdown-item"><span class="icon">üìã</span> Audit-Log</a>
          </div>
          <div class="dropdown-section">
            <div class="dropdown-label">Apps</div>
            <a href="https://app.sbsdeutschland.com" class="dropdown-item cross-link"><span class="icon">üìÑ</span> ‚Üí KI-Rechnungen</a>
          </div>
        </div>
      </div>
    </nav>
  </div>
</header>
'''


def get_footer():
    """Footer exakt wie in der Upload-Page."""
    return '''
<footer>
  <div class="footer-container">
    <div class="footer-grid">
      <div class="footer-brand">
        <div class="footer-logo">
          <img src="/static/sbs-logo-new.png" alt="SBS Logo" onerror="this.style.display='none'">
          <div class="footer-logo-text">
            <span class="name">SBS Deutschland</span>
            <span class="sub">Smart Business Service</span>
          </div>
        </div>
        <p class="footer-tagline">Enterprise KI-Vertragsanalyse.<br>Entwickelt und betrieben in Deutschland.</p>
        <div class="footer-address">üìç In der Dell 19, 69469 Weinheim</div>
      </div>
      
      <div class="footer-section">
        <h4>App</h4>
        <ul>
          <li><a href="/upload">Analyse</a></li>
          <li><a href="/history">Verlauf</a></li>
          <li><a href="/analytics">Analytics</a></li>
          <li><a href="/compare">Vergleich</a></li>
          <li><a href="/library">Bibliothek</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>Konto</h4>
        <ul>
          <li><a href="/settings">Einstellungen</a></li>
          <li><a href="/billing">Abrechnung</a></li>
          <li><a href="/team">Team</a></li>
          <li><a href="/exports">Export-Historie</a></li>
        </ul>
      </div>
      
      <div class="footer-section">
        <h4>Support</h4>
        <ul>
          <li><a href="/help">Hilfe & FAQ</a></li>
          <li><a href="mailto:info@sbsdeutschland.com">Kontakt</a></li>
          <li><a href="/impressum">Impressum</a></li>
          <li><a href="/datenschutz">Datenschutz</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom">¬© 2025 SBS Deutschland GmbH & Co. KG</div>
  </div>
</footer>
'''


def page_wrapper(title: str, content: str, user_name: str = "User", active: str = ""):
    """Wrapper f√ºr alle Seiten."""
    return f'''<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{title} | SBS Contract Intelligence</title>
  <link rel="icon" href="/static/favicon.ico">
  {PAGE_CSS}
</head>
<body>
{get_header(user_name, active)}
<main>
{content}
</main>
{get_footer()}
</body>
</html>'''


# ============================================================================
# TOOL PAGES
# ============================================================================

def get_compare_page(user_name: str = "User"):
    content = '''
<div class="hero">
  <div class="container">
    <div class="hero-badge"><span class="dot"></span> VERTRAGSVERGLEICH</div>
    <h1>‚öñÔ∏è Vertr√§ge vergleichen</h1>
    <p>Vergleichen Sie zwei Vertr√§ge nebeneinander und identifizieren Sie Unterschiede.</p>
  </div>
</div>
<div class="page-container">
  <div class="grid-2">
    <div class="content-card">
      <div class="content-card-header"><h3 class="content-card-title">üìÑ Vertrag A</h3></div>
      <div class="content-card-body">
        <div class="empty-state" style="padding:40px;">
          <div class="empty-icon">üì§</div>
          <p style="font-weight:600;margin-bottom:16px;">Vertrag ausw√§hlen</p>
          <select class="form-input" style="max-width:280px;margin:0 auto;"><option>-- Vertrag ausw√§hlen --</option></select>
        </div>
      </div>
    </div>
    <div class="content-card">
      <div class="content-card-header"><h3 class="content-card-title">üìÑ Vertrag B</h3></div>
      <div class="content-card-body">
        <div class="empty-state" style="padding:40px;">
          <div class="empty-icon">üì§</div>
          <p style="font-weight:600;margin-bottom:16px;">Vertrag ausw√§hlen</p>
          <select class="form-input" style="max-width:280px;margin:0 auto;"><option>-- Vertrag ausw√§hlen --</option></select>
        </div>
      </div>
    </div>
  </div>
  <div style="text-align:center;margin-top:24px;"><button class="btn btn-primary" disabled style="opacity:0.5;">‚öñÔ∏è Vergleich starten</button></div>
</div>'''
    return page_wrapper("Vertragsvergleich", content, user_name, "tools")


def get_library_page(user_name: str = "User"):
    clauses = [
        (1, "K√ºndigungsklausel Standard", "Allgemein", "success", "Niedrig", 47),
        (2, "Haftungsbegrenzung 1x ACV", "SaaS", "warning", "Mittel", 32),
        (3, "Geheimhaltung 5 Jahre", "NDA", "success", "Niedrig", 28),
        (4, "Auto-Renewal 30 Tage", "SaaS", "success", "Niedrig", 25),
        (5, "Datenlokation EU", "SaaS", "success", "Niedrig", 21),
        (6, "Eigentums√ºbergang", "Kaufvertrag", "success", "Niedrig", 19),
        (7, "Vertragsstrafe 10%", "Lieferant", "warning", "Mittel", 15),
        (8, "Indexmiete j√§hrlich", "Mietvertrag", "warning", "Mittel", 12),
    ]
    rows = "".join([f'<tr><td><strong>{c[1]}</strong></td><td><span class="badge badge-info">{c[2]}</span></td><td><span class="badge badge-{c[3]}">{c[4]}</span></td><td>{c[5]}x</td><td><a href="/library/clause/{c[0]}" class="btn btn-secondary" style="padding:6px 14px;font-size:0.8rem;">Ansehen</a></td></tr>' for c in clauses])
    
    content = f'''
<div class="hero">
  <div class="container">
    <div class="hero-badge"><span class="dot"></span> KLAUSEL-BIBLIOTHEK</div>
    <h1>üìö Klausel-Bibliothek</h1>
    <p>Sammlung von Standardklauseln und Best Practices f√ºr verschiedene Vertragstypen.</p>
  </div>
</div>
<div class="page-container">
  <div class="stats-grid">
    <div class="stat-card"><div class="stat-value">48</div><div class="stat-label">Klauseln gesamt</div></div>
    <div class="stat-card"><div class="stat-value">8</div><div class="stat-label">Vertragstypen</div></div>
    <div class="stat-card"><div class="stat-value">234</div><div class="stat-label">Verwendungen</div></div>
    <div class="stat-card"><div class="stat-value">12</div><div class="stat-label">Eigene Klauseln</div></div>
  </div>
  <div class="content-card">
    <div class="content-card-header"><h3 class="content-card-title">Klauseln</h3><button class="btn btn-primary">+ Neue Klausel</button></div>
    <div class="content-card-body" style="padding:0;">
      <table class="data-table">
        <thead><tr><th>Klausel</th><th>Typ</th><th>Risiko</th><th>Nutzung</th><th>Aktion</th></tr></thead>
        <tbody>{rows}</tbody>
      </table>
    </div>
  </div>
</div>'''
    return page_wrapper("Klausel-Bibliothek", content, user_name, "tools")


def get_exports_page(user_name: str = "User"):
    exports = [
        ("22.12.2025 14:32", "test_nda_analyse.pdf", "PDF", "danger", "124 KB"),
        ("22.12.2025 14:30", "test_nda_analyse.json", "JSON", "info", "8 KB"),
        ("18.12.2025 12:45", "saas_vertrag.pdf", "PDF", "danger", "156 KB"),
    ]
    rows = "".join([f'<tr><td>{e[0]}</td><td><strong>{e[1]}</strong></td><td><span class="badge badge-{e[3]}">{e[2]}</span></td><td>{e[4]}</td><td><button class="btn btn-secondary" style="padding:6px 14px;font-size:0.8rem;">‚¨áÔ∏è Download</button></td></tr>' for e in exports])
    
    content = f'''
<div class="hero">
  <div class="container">
    <div class="hero-badge"><span class="dot"></span> EXPORT-HISTORIE</div>
    <h1>üì• Export-Historie</h1>
    <p>√úbersicht aller exportierten Analysen und Reports.</p>
  </div>
</div>
<div class="page-container">
  <div class="stats-grid" style="grid-template-columns:repeat(3,1fr);">
    <div class="stat-card"><div class="stat-value">127</div><div class="stat-label">Exporte gesamt</div></div>
    <div class="stat-card"><div class="stat-value">89</div><div class="stat-label">PDF Reports</div></div>
    <div class="stat-card"><div class="stat-value">38</div><div class="stat-label">JSON Exporte</div></div>
  </div>
  <div class="content-card">
    <div class="content-card-header"><h3 class="content-card-title">Letzte Exporte</h3></div>
    <div class="content-card-body" style="padding:0;">
      <table class="data-table">
        <thead><tr><th>Datum</th><th>Datei</th><th>Format</th><th>Gr√∂√üe</th><th>Aktion</th></tr></thead>
        <tbody>{rows}</tbody>
      </table>
    </div>
  </div>
</div>'''
    return page_wrapper("Export-Historie", content, user_name, "tools")


# ============================================================================
# KONTO PAGES
# ============================================================================

def get_settings_page(user_name: str = "User", user_email: str = "user@example.com"):
    content = f'''
<div class="hero">
  <div class="container">
    <div class="hero-badge"><span class="dot"></span> EINSTELLUNGEN</div>
    <h1>‚öôÔ∏è Einstellungen</h1>
    <p>Verwalten Sie Ihre Kontoeinstellungen und Pr√§ferenzen.</p>
  </div>
</div>
<div class="page-container">
  <div class="grid-2">
    <div>
      <div class="content-card">
        <div class="content-card-header"><h3 class="content-card-title">üë§ Profil</h3></div>
        <div class="content-card-body">
          <div class="form-group"><label class="form-label">Name</label><input type="text" class="form-input" value="{user_name}"></div>
          <div class="form-group"><label class="form-label">E-Mail</label><input type="email" class="form-input" value="{user_email}"></div>
          <div class="form-group"><label class="form-label">Unternehmen</label><input type="text" class="form-input" value="SBS Deutschland GmbH & Co. KG"></div>
          <button class="btn btn-primary">Speichern</button>
        </div>
      </div>
      <div class="content-card">
        <div class="content-card-header"><h3 class="content-card-title">üîî Benachrichtigungen</h3></div>
        <div class="content-card-body">
          <div class="form-group"><label style="display:flex;align-items:center;gap:12px;cursor:pointer;"><input type="checkbox" checked style="width:18px;height:18px;"><span>E-Mail bei abgeschlossener Analyse</span></label></div>
          <div class="form-group"><label style="display:flex;align-items:center;gap:12px;cursor:pointer;"><input type="checkbox" checked style="width:18px;height:18px;"><span>E-Mail bei kritischen Risiken</span></label></div>
          <button class="btn btn-secondary">Speichern</button>
        </div>
      </div>
    </div>
    <div>
      <div class="content-card">
        <div class="content-card-header"><h3 class="content-card-title">üîë API-Zugang</h3></div>
        <div class="content-card-body">
          <div class="form-group">
            <label class="form-label">API-Key</label>
            <div style="display:flex;gap:8px;"><input type="password" class="form-input" value="sk-contract-xxxx" readonly style="font-family:monospace;"><button class="btn btn-secondary">üëÅÔ∏è</button></div>
            <p class="form-hint">Letzte Nutzung: Heute</p>
          </div>
          <button class="btn btn-danger">Neuen Key generieren</button>
        </div>
      </div>
      <div class="content-card">
        <div class="content-card-header"><h3 class="content-card-title">ü§ñ Analyse-Einstellungen</h3></div>
        <div class="content-card-body">
          <div class="form-group"><label class="form-label">KI-Modell</label><select class="form-input"><option selected>GPT-4o-mini (schnell)</option><option>GPT-4o (genauer)</option></select><p class="form-hint">GPT-4o ist genauer, aber langsamer.</p></div>
          <button class="btn btn-primary">Speichern</button>
        </div>
      </div>
    </div>
  </div>
</div>'''
    return page_wrapper("Einstellungen", content, user_name, "settings")


def get_billing_page(user_name: str = "User"):
    content = '''
<div class="hero">
  <div class="container">
    <div class="hero-badge"><span class="dot"></span> ABRECHNUNG</div>
    <h1>üí≥ Abrechnung</h1>
    <p>Verwalten Sie Ihren Plan und sehen Sie Ihre Rechnungen ein.</p>
  </div>
</div>
<div class="page-container">
  <div class="content-card" style="border:2px solid var(--sbs-yellow);background:linear-gradient(135deg,#fffbeb 0%,#fef3c7 100%);margin-bottom:32px;">
    <div class="content-card-body">
      <div style="display:flex;justify-content:space-between;align-items:center;flex-wrap:wrap;gap:24px;">
        <div>
          <div style="font-size:0.8rem;color:var(--sbs-muted);">AKTUELLER PLAN</div>
          <div style="font-size:1.8rem;font-weight:700;color:var(--sbs-blue);">Professional</div>
          <div style="color:var(--sbs-muted);">179 ‚Ç¨ / Monat</div>
        </div>
        <div style="text-align:right;">
          <div style="font-size:0.8rem;color:var(--sbs-muted);">Vertr√§ge diesen Monat</div>
          <div style="font-size:2rem;font-weight:700;color:var(--sbs-blue);">47 / 100</div>
          <div style="background:var(--sbs-border);border-radius:4px;height:8px;width:200px;margin-top:8px;"><div style="background:var(--sbs-yellow);border-radius:4px;height:100%;width:47%;"></div></div>
        </div>
      </div>
    </div>
  </div>
  <h3 style="margin-bottom:20px;color:var(--sbs-blue);">Verf√ºgbare Pl√§ne</h3>
  <div class="grid-3">
    <div class="plan-card"><h4 style="color:var(--sbs-blue);">Starter</h4><div class="plan-price">69 ‚Ç¨</div><div style="color:var(--sbs-muted);">pro Monat</div><ul class="plan-features"><li>‚úì 25 Vertr√§ge/Monat</li><li>‚úì 3 Vertragstypen</li><li>‚úì PDF Export</li></ul><button class="btn btn-secondary" style="width:100%;">Downgrade</button></div>
    <div class="plan-card current"><div style="background:var(--sbs-yellow);color:var(--sbs-blue);font-size:0.7rem;font-weight:700;padding:4px 12px;border-radius:12px;display:inline-block;margin-bottom:12px;">AKTUELL</div><h4 style="color:var(--sbs-blue);">Professional</h4><div class="plan-price">179 ‚Ç¨</div><div style="color:var(--sbs-muted);">pro Monat</div><ul class="plan-features"><li>‚úì 100 Vertr√§ge/Monat</li><li>‚úì Alle 8 Vertragstypen</li><li>‚úì PDF + JSON Export</li><li>‚úì Klausel-Bibliothek</li></ul><button class="btn btn-primary" style="width:100%;" disabled>Aktueller Plan</button></div>
    <div class="plan-card"><h4 style="color:var(--sbs-blue);">Enterprise</h4><div class="plan-price">449 ‚Ç¨+</div><div style="color:var(--sbs-muted);">pro Monat</div><ul class="plan-features"><li>‚úì Unbegrenzte Vertr√§ge</li><li>‚úì SSO / SAML</li><li>‚úì API-Zugang</li><li>‚úì Custom Prompts</li></ul><button class="btn btn-primary" style="width:100%;">Upgrade</button></div>
  </div>
</div>'''
    return page_wrapper("Abrechnung", content, user_name, "settings")


def get_team_page(user_name: str = "User"):
    content = '''
<div class="hero">
  <div class="container">
    <div class="hero-badge"><span class="dot"></span> TEAM</div>
    <h1>üë• Team verwalten</h1>
    <p>Laden Sie Teammitglieder ein und verwalten Sie Berechtigungen.</p>
  </div>
</div>
<div class="page-container">
  <div class="stats-grid">
    <div class="stat-card"><div class="stat-value">3</div><div class="stat-label">Teammitglieder</div></div>
    <div class="stat-card"><div class="stat-value">1</div><div class="stat-label">Admins</div></div>
    <div class="stat-card"><div class="stat-value">5</div><div class="stat-label">Max. Sitze</div></div>
    <div class="stat-card"><div class="stat-value">2</div><div class="stat-label">Verf√ºgbar</div></div>
  </div>
  <div class="content-card">
    <div class="content-card-header"><h3 class="content-card-title">Teammitglieder</h3><button class="btn btn-primary">+ Einladen</button></div>
    <div class="content-card-body" style="padding:0;">
      <table class="data-table">
        <thead><tr><th>Mitglied</th><th>Rolle</th><th>Status</th><th>Aktivit√§t</th><th>Aktion</th></tr></thead>
        <tbody>
          <tr><td><div class="user-row"><div class="user-avatar-large">L</div><div class="user-info"><strong>Luis Schenk</strong><small>luis@sbsdeutschland.com</small></div></div></td><td><span class="badge badge-danger">Admin</span></td><td><span class="badge badge-success">Aktiv</span></td><td style="color:var(--sbs-muted);">Gerade online</td><td><button class="btn btn-secondary" style="padding:6px 14px;font-size:0.8rem;">Bearbeiten</button></td></tr>
          <tr><td><div class="user-row"><div class="user-avatar-large">A</div><div class="user-info"><strong>Anna Weber</strong><small>anna@sbsdeutschland.com</small></div></div></td><td><span class="badge badge-info">Editor</span></td><td><span class="badge badge-success">Aktiv</span></td><td style="color:var(--sbs-muted);">Vor 2h</td><td><button class="btn btn-secondary" style="padding:6px 14px;font-size:0.8rem;">Bearbeiten</button></td></tr>
        </tbody>
      </table>
    </div>
  </div>
</div>'''
    return page_wrapper("Team", content, user_name, "settings")


def get_audit_page(user_name: str = "User"):
    logs = [
        ("22.12.2025 14:32", "Luis Schenk", "PDF Export", "test_nda.pdf", "80.89.68.219"),
        ("22.12.2025 14:30", "Luis Schenk", "Analyse", "test_nda.pdf", "80.89.68.219"),
        ("22.12.2025 12:15", "Anna Weber", "Login", "-", "91.124.45.67"),
    ]
    rows = "".join([f'<tr><td style="font-family:monospace;font-size:0.85rem;">{l[0]}</td><td><strong>{l[1]}</strong></td><td><span class="badge badge-info">{l[2]}</span></td><td>{l[3]}</td><td style="font-family:monospace;font-size:0.85rem;color:var(--sbs-muted);">{l[4]}</td></tr>' for l in logs])
    
    content = f'''
<div class="hero">
  <div class="container">
    <div class="hero-badge"><span class="dot"></span> AUDIT-LOG</div>
    <h1>üìã Audit-Log</h1>
    <p>Vollst√§ndige Protokollierung aller Aktivit√§ten.</p>
  </div>
</div>
<div class="page-container">
  <div class="content-card">
    <div class="content-card-header"><h3 class="content-card-title">Aktivit√§ten</h3><button class="btn btn-secondary">CSV Export</button></div>
    <div class="content-card-body" style="padding:0;">
      <table class="data-table">
        <thead><tr><th>Zeitstempel</th><th>Benutzer</th><th>Aktion</th><th>Details</th><th>IP-Adresse</th></tr></thead>
        <tbody>{rows}</tbody>
      </table>
    </div>
  </div>
</div>'''
    return page_wrapper("Audit-Log", content, user_name, "settings")
